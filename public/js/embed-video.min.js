$(window).load(function(){videoManager.init()});var EmbededVideoManager=function(){this.init=function(){var a=this;$(".embed-video-wrapper input").each(function(){var b=$(this);if(b.data("oldVal",b.val()),""!==b.val()){var c=a.extractVideoID(b.val());if(null!==c){var d=$(this).parents(".embed-video-wrapper").find(".preview-box");d.find(".placeholders .idle").hide(),a.appendVideo(d,c)}}a.bindEvents(b)})},this.rebuild=function(){var a=this;$(".embed-video-wrapper input").each(function(){var b=$(this);b.data("oldVal",b.val()),a.bindEvents(b)})},this.bindEvents=function(a){var b=this;a.on("propertychange change click keyup input paste",function(){if(a.data("oldVal")!==a.val()){$el=$(this).parents(".embed-video-wrapper").find(".preview-box"),$(this).parents(".embed-video-wrapper").find("iframe").remove(),$el.find(".placeholders .error").hide(),a.removeClass("has-error"),a.data("oldVal",a.val());var c=b.extractVideoID(a.val());Object.keys(c).length?($el.find(".placeholders .idle").hide(),b.appendVideo($el,c)):""!==a.val()?($el.find(".placeholders .idle").hide(),$el.find(".placeholders .error").show(),a.addClass("has-error")):$el.find(".placeholders .idle").show()}})},this.extractVimeoID=function(a){var b=a.split("/"),c=b.slice(-1).toString();return c},this.extractYoutubeID=function(a){var b=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/i,c=a.match(b);return c&&11===c[7].length?c[7]:null},this.extractVideoID=function(a){var b={};return a.search(/youtu\.?be/i)!==-1?(b.videoID=this.extractYoutubeID(a),b.videoSource="youtube"):a.search("vimeo")!==-1&&(b.videoID=this.extractVimeoID(a),b.videoSource="vimeo"),b},this.appendVideo=function(a,b){switch(b.videoSource){case"youtube":$videoIframe='<iframe src="https://www.youtube.com/embed/'+b.videoID+'" frameborder="0" allowfullscreen></iframe>';break;case"vimeo":$videoIframe='<iframe src="https://player.vimeo.com/video/'+b.videoID+'" frameborder="0" mozallowfullscreen allowfullscreen></iframe>';break;default:return!1}$(a).find(".placeholders i").hide(),$(a).append($videoIframe)},this.createVideoSlot=function(a,b,c){var d='<div class="embed-video-wrapper"><div class="form-group text"><label for="video_url">'+c+'</label><span class="remove-video glyphicon glyphicon-remove"></span><input class="form-control embed-video" id="'+b+'" name="'+b+'" type="text" value=""></div><div class="preview-box"><div class="placeholders"><div class="idle glyphicon glyphicon-film"></div><div class="error glyphicon glyphicon-exclamation-sign"></div></div></div></div>';return $(a).append($(d))}},videoManager=new EmbededVideoManager;